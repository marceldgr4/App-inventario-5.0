<?!= include("View/Css/Css_Generico.html"); ?>

    <?!= include("View/Css/Css_Comida.html"); ?>
    <?!= include("View/Css/Css_Tablas.html"); ?>
    <?!= include("View/Css/Css_Filtros.html"); ?>
    <?!= include("View/Css/Css_Notifications.html"); ?>
    <?!= include("View/Css/Css_Modal.html"); ?>
    <?!= include("View/Css/Css_Comentarios.html"); ?>

<div id="comidaContent" class="inventory-container">
    <div class="header-section">
        <h1>Comida</h1>
        <p>Gestión de inventario de productos.</p>
        
        <div class="action-bar">
            <div class="button-group">
                <button class="btn btn-primary" onclick="abrirModalAgregarComida()">
                    <ion-icon name="add-circle-outline"></ion-icon> Agregar Comida
                </button>
                <button class="btn btn-secondary" onclick="abrirModalVencimientoComida()">
                    <ion-icon name="notifications-outline"></ion-icon> Notificaciones
                    <div id="notificacionContainer">
                        <span id="notificacionCantidad" style="display: none;"></span>
                    </div>
                </button>
                <!--Notificacion de comentarios-->
                <button class="btn btn-secondary" onclick="abrirModalNotificacionComentarioComida()">
                    <ion-icon name="chatbubble-ellipses-outline"></ion-icon> Notificaciones de Comentarios
                    <div id="notificacionContainerComentariosComida">
                    <span id="notificacionCantidadComentarios" style="display: none;"></span>
                    </div>
                </button>
            </div>
            <div class="search-group">
                <input type="text" id="buscarComida" class="search-input" placeholder="Buscar por nombre de producto...">
                <button class="btn btn-outline" onclick="aplicarFiltrosYOrdenar()">
                    <i class="fas fa-search"></i> Buscar
                </button>
                <button class="btn btn-outline" onclick="limpiarTodosLosFiltros()">
                    <i class="fas fa-times"></i> Limpiar
                </button>
            </div>
        </div>
    </div>
    <!--filtros-->
    <div class="filtro">
        <div id="toggleFiltrosComidaIconContainer" style="cursor: pointer;">
            <ion-icon name="filter-outline" style="font-size: 20px; vertical-align: middle;"></ion-icon>
            <span style="vertical-align: middle; margin-left: 5px;">Filtros</span>
        </div>
         <div id="filtrosAdicionalesContainer" class="filtros-adicionales-ocultos">
            <div class="filtro-item">
                <label for="filtroUbicacionComida">Ubicación:</label>
                <input type="text" id="filtroUbicacionComida" class="form-control" placeholder="Bodega/Nevera"> 
                <label for="filtroEstadoProductoComida">Estado del Producto:</label>
                <input type="text" id="filtroEstadoProductoComida" class="form-control" placeholder="Bueno /Regular/Malo"> 
                <label for="filtroUnidadesComida">Mín. Unidades:</label>
                <input type="number" id="filtroUnidadesComida" class="form-control" placeholder="1,2,3" title="Mínimo de Unidades Disponibles" min="0">
                
                <label for="filtroEstadoComidaSelect">Estado:</label>
                <select id="filtroEstadoComidaSelect" class="form-control">
                    <option value="activo" selected>Activo</option>
                    <option value="desactivado">Desactivado</option>
                    <option value="">Todos</option> 
                </select>
            </div>
            
        </div>
    </div>

    <div id="sortContainer">
        <span>Ordenar por Fecha de Ingreso:</span>
        <i class="fas fa-sort sort-menu-icon" onclick="ordenarPorFecha(event)"></i>
        <div id="sortOptionsComida" class="sort-options">
             <a href="#" onclick="ordenarAscendente(); return false;">Ascendente</a>
             <a href="#" onclick="ordenarDescendente(); return false;">Descendente</a>
        </div>
    </div>
    
    <div id="noData" class="no-data-container" style="display:none;">
        <i class="fas fa-inbox no-data-icon"></i>
        <h3 class="no-data-title">No se encontraron artículos de comoda en inventario</h3>
        <p>Haz clic en "Agregar producto" para añadir tu primer artículo</p>
    </div>

    <div class="table-container-Comida">
        <table id="comidaTable" class="inventory-table">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Nombre del Producto</th>
                    <th>Precio $</th>
                    <th>Ubicación</th>
                    <th>Est. producto</th>
                    <th>Fecha De Ingreso</th>
                    <th>U. Ingresos</th>
                    <th>U. Retiradas</th>
                    <th>U.disponibles</th>
                    <th>Fecha de Vencimiento</th>
                    <th>Comentarios</th>
                    
                  
                    <th>Acciones</th>
                </tr>
            </thead>
            <tbody id="tablaComidaBody"></tbody>
        </table>
        <div id="comidaPagination" class="pagination"></div>
    </div>
    <!--MODALES -->
    <!--AGREGAR-->
    <div id="modalAgregarComida" class="modal-overlay">
        <div class="modal-content-A">
            <div class="modal-header">
                <h2>Agregar Comida</h2>
                <span class="close-btn" onclick="cerrarModalAgregarComida()">&times;</span>
            </div>
            <form id="agregarComidaForm">
                <div class="form-group">
                    <label for="productoAgregarComida">Nombre del Producto *:</label>
                    <input type="text" id="productoAgregarComida" name="productoAgregar" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="precioAgregarComida"> Precio *:</label>
                    <input type="text" id="precioAgregarComida" class="form-control" placeholder="$ 0.00" required>
                    <span id="errorPrecioAgregarComida" style="color:red; display:none;"></span>
                </div>
                <div class="form-group">
                    <label for="ubicacionAgregarComida">Ubicación:</label>
                    <select id="ubicacionAgregarComida" name="ubicacionAgregar" class="form-control">
                        <option value="" selected disabled>Seleccione una ubicación</option>
                        <option value="Storage">Storage</option>
                        <option value="Nevera">Nevera</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="estadoAgregarComida">Estado del producto:</label>
                    <select id="estadoAgregarComida" name="estadoAgregar" class="form-control">
                        <option value="" selected disabled>Seleccione un estado</option>
                        <option value="Disponible">Disponible / Bueno</option>
                        <option value="Usado">Usado</option>
                        <option value="Perdido">Perdido Con Observaciones</option>
                       
                    </select>
                </div>
                <div class="form-group">
                    <label for="ingresosAgregarComida">Unidades a Ingresos *:</label>
                    <input type="number" id="ingresosAgregarComida" class="form-control" min="0" required>
                </div>
                <div class="form-group">
                    <label for="fechaVencimientoAgregarComida">Fecha de Vencimiento:</label>
                    <input type="date" id="fechaVencimientoAgregarComida" class="form-control">
                </div>
                <div class="form-group">
                    <label for="comentariosAgregarComida">Comentarios:</label>
                    <textarea id="comentariosAgregarComida" rows="4" class="form-control"></textarea>
                </div>
                <div class="modal-footer">
                    <button type="submit" class="btn btn-primary">Guardar Comida</button>
                </div>
            </form>
        </div>
    </div>
    <!--EDITAR-->
    <div id="modalEditarComida" class="modal-overlay">
        <div class="modal-content-A">
            <div class="modal-header">
                <h2>Modificar Comida</h2>
                <span class="close-btn" onclick="cerrarModalEditarComida()">&times;</span>
            </div>
            <p>ID de Comida: <span id="productoIdEditarComida"></span></p>
            <form id="editarComidaForm">
                <div class="form-group">
                    <label for="productoEditarComida">Nombre del Producto *:</label>
                    <input type="text" id="productoEditarComida" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="precioEditarComida">Precio *:</label>
                    <input type="text" id="precioEditarComida" class="form-control" placeholder="$ 0.00" required>
                    <span id="errorPrecioEditarComida" style="color:red; display:none;"></span>
                </div>
                <div class="form-group">
                    <label for="ubicacionEditarComida">Ubicación :</label>
                    <input type="text" id="ubicacionEditarComida" class="form-control">
                </div>
                <div class="form-group">
                    <label for="estadoEditarComida">Estado del producto:</label>
                    <!--input type="text" id="estadoEditarComida" class="form-control"-->
                    <select id="estadoEditarComida" name="estadoEditar" class="form-control">
                    <option value="" selected disabled>Seleccione un estado</option>
                        <option value="Disponible">Disponible / Bueno</option>
                        <option value="Usado">Usado</option>
                        <option value="Perdido">Perdido Con Observaciones</option>
                        <option value="Vencido">Vencido</option>
                        <option value="Dañado">Dañado</option>
                       
                    </select>
                </div>
                <div class="form-group">
                    <label for="unidadesAgregarEditarComida">Unidades a agregar*:</label>
                    <input type="number" id="unidadesAgregarEditarComida" class="form-control" min="0" value="0" required>
                </div>
                <div class="form-group">
                    <label for="fechaVencimientoEditarComida">Fecha de Vencimiento:</label>
                    <input type="date" id="fechaVencimientoEditarComida" class="form-control">
                </div>
                <div class="form-group">
                    <label for="comentariosEditarComida">Comentarios:</label>
                    <textarea id="comentariosEditarComida" rows="4" class="form-control"></textarea>
                </div>
                <div class="modal-footer">
                    <button type="submit" class="btn btn-primary">
                        <span><ion-icon name="cloud-upload-outline"></ion-icon></span> Guardar Cambios
                    </button>
                </div>
            </form>
        </div>
    </div>
    <!--RETIRAR-->
    <div id="modalRetiroComida" class="modal-overlay">
        <div class="modal-content-A">
            <div class="modal-header">
                <h2>Retirar producto de Comida</h2>
                <span class="close-btn" onclick="cerrarModalRetiroComida()">&times;</span>
            </div>
            <p>ID de Comida: <span id="productoIdRetiroComida"></span></p>
            <p>Producto: <span id="productoNombreRetiroComida"></span></p>
            <p>Unidades Disponibles: <span id="unidadesDisponiblesRetiroComida"></span></p>
            <form id="retiroComidaForm">
                <div class="form-group">
                    <label for="unidadesRetirarComida" class="required"> Unidades a retirar *:</label>
                    <input type="number" id="unidadesRetirarComida" class="form-control" min="1" required>
                </div>
                <div class="modal-footer">
                    <button type="submit" class="btn btn-primary">
                        <span><ion-icon name="bag-check-outline"></ion-icon></span> Retirar
                    </button>
                </div>
            </form>
        </div>
    </div>
    <!--COMENTARIO-->
    <div id="modalComentarioComida" class="modal-overlay">
        <div class="modal-content-A">
            <div class="modal-header">
                <h2>Agregar Comentario</h2>
                <span class="close-btn" onclick="cerrarModalComentarioComida()">&times;</span>
            </div>
            <p>ID de Comida: <span id="comentarioProductoIdComida"></span></p>
            <p>Producto: <span id="comentarioProductoNombreComida"></span></p>
            <form id="comentarioComidaForm">
                <div class="form-group">
                    <label for="comentarioTextoComida">Comentario *:</label>
                    <textarea id="comentarioTextoComida" rows="4" class="form-control" required></textarea>
                </div>
                <div class="modal-footer">
                    <button type="submit" class="btn btn-primary">Guardar Comentario</button>
                </div>
            </form>
        </div>
    </div>

    <div id="modalVencimiento-Comida" class="modal-overlay">
        <div class="modal-content-vencimiento">
            <div class="modal-header">
                <h2 class="modal-title">
                    <ion-icon name="notifications-outline"></ion-icon> Notificaciones de Vencimiento
                </h2>
                <div class="modal-header-actions"></div>
      <button class="btn-warning" onclick="loadComentarios()">
                    <ion-icon name="refresh-circle-outline"></ion-icon> Cargar Nuevas
                </button>
                <button class="close-btn" onclick="cerrarModalVencimientoComida()">&times;</button>
            </div>

            <div class="modal-body">
                <div id="vencimientoTabs" class="tab-buttons-container">
                    <button class="tab-button active" data-tab="proximos" onclick="mostrarTab('proximos', this)">Próximos</button>
                    <button class="tab-button" data-tab="vencidos" onclick="mostrarTab('vencidos', this)">Vencidos</button>
                </div>

                <div id="proximos" class="tab-content active">
                    <h4>Productos Próximos a Vencer</h4>
                    <table id="tablaProximosVencimiento">
                        <thead>
                            <tr>
                                <th>Id</th>
                                <th>Producto</th>
                                <th>Días Restantes</th>
                                <th>Estado Físico</th>
                                <th>Ubicación</th>
                                <th>Unidades</th>
                            </tr>
                        </thead>
                        <tbody id="tablaProximosVencimientoBody"></tbody>
                    </table>
                </div>

                <div id="vencidos" class="tab-content">
                    <h4>Productos Vencidos</h4>
                    <table id="tablaVencidos">
                        <thead>
                            <tr>
                                <th>Id</th>
                                <th>Producto</th>
                                <th>Días Vencido</th>
                                <th>Estado Físico</th>
                                <th>Ubicación</th>
                                <th>Unidades</th>
                            </tr>
                        </thead>
                        <tbody id="tablaVencidosBody"></tbody>
                    </table>
                </div>
            </div>

            <div id="paginationNotificacionesVencimiento" class="pagination-controls">
            </div>
            <div class="modal-footer"> 
                <button class="btn btn-danger" id="btnBorrarSeleccionadosVencimiento" onclick="deactivateSelectedNotifications()">
                    <ion-icon name="close-circle-outline"></ion-icon> Borrar Elemento
                </button>
                <button class="btn btn-secondary" onclick="limpiarNotificaciones()">
                <ion-icon name="trash-outline"></ion-icon> Limpiar Notificaciones
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Modal de Notificaciones de Comentarios -->
<div id="modalNotificacion-Comentario" class="modal-overlay">
    <div class="modal-content-NotificacionesComentarios">
        <div class="modal-header">
            <h2 class="modal-title">
                <ion-icon name="chatbubble-ellipses-outline"></ion-icon> Mis Notificaciones de Comentarios
            </h2>
            <button class="btn-warning" onclick="cargarNotificacionesDeComentarios()">
                <ion-icon name="refresh-outline"></ion-icon> Recargar
            </button>
            <button class="close-btn" onclick="cerrarModalNotificacionComentarioComida()">&times;</button>
        </div>
        <div class="modal-body">
            <div class="tab-buttons-container">
                <button class="tab-button active" data-tab="pendientes-comentarios">Pendientes</button>
                <button class="tab-button" data-tab="leidas-comentarios">Leídas</button>
            </div>

            <!-- Pestaña de Pendientes -->
            <div id="pendientes-comentarios" class="tab-content active">
                <div class="table-container-notificaciones">
                    <table class="notifications-table">
                        <thead>
                            <tr>
                                <th>Producto</th>
                                <th>Tu Comentario</th>
                                <th>Respuesta del Admin</th>
                                <th>Acción</th>
                            </tr>
                        </thead>
                        <tbody id="notificacionesPendientesBody"></tbody>
                    </table>
                </div>
            </div>

            <!-- Pestaña de Leídas -->
            <div id="leidas-comentarios" class="tab-content">
                <div class="table-container-notificaciones">
                    <table class="notifications-table">
                        <thead>
                            <tr>
                                <th>Producto</th>
                                <th>Tu Comentario</th>
                                <th>Respuesta</th>
                                <th>Acción</th>
                            </tr>
                        </thead>
                        <tbody id="notificacionesLeidasBody"></tbody>
                    </table>
                </div>
            </div>
        </div>
        <div class="modal-footer">
            <p class="footer-info">Aquí puedes ver las respuestas a tus comentarios.</p>
        </div>
    </div>
</div>


<div id="mensajeConfirmacionComida" class="mensaje-confirmacion" style="display:none;">
    <span></span>
    <button onclick="cerrarMensaje()">Cerrar</button>
</div>
<?!= include("View/Js/Js_Generico.html"); ?>
<?!= include("View/Js/Js_Comida.html"); ?>
 <?!= include("View/Js/Js_Notifications.html"); ?>