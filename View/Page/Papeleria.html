<?!= include("View/Css/Css_Generico.html"); ?>
<?!= include("View/Css/Css_Tablas.html"); ?>
<?!= include("View/Css/Css_Filtros.html"); ?>
<?!= include("View/Css/Css_Notifications.html"); ?>
<?!= include("View/Css/Css_Comentarios.html"); ?>
<?!= include("View/Css/Css_Modal.html"); ?>

<div id="papeleriaContent" class="inventory-container">
  <div class="header-section">
    <h1>Papelería</h1>
    <p>Gestión de inventario de artículos de papelería.</p>


  <div class="action-bar">
    <div class="butoon-group">
      <button class="btn btn-primary" onclick="abrirModalAgregar()">
        <ion-icon name="add-circle-outline"></ion-icon> Agregar Papelería
      </button>
      <button class="btn btn-secondary" onclick="abrirModalNotificacionComentario()">
        <ion-icon name="chatbubble-ellipses-outline"></ion-icon> Noficaciones de Comentarios
        <div id="notificacionContainerPapeleria">
        <span id="notificacionCantidadComentarios" style="display: none;"></span>
        </div>
        </button>
    </div>
    <div class="search-group">
      <input type="text" id="buscarPapeleria" class="search-input" placeholder="Buscar por nombre de artículo...">
      <button class="btn btn-outline" onclick="aplicarFiltrosYOrdenar()">
        <i class="fas fa-search"></i> Buscar
      </button>
      <button class="btn btn-outline" onclick="limpiarTodosLosFiltros()">
        <i class="fas fa-times"></i> Limpiar
      </button>
    </div>
  </div>
</div>

  <div class="filtro">
    <div id="toggleFiltrosPapeleriaIconContainer" style= "cursor: pointer;">
      <ion-icon name="filter-outline" style="font-size: 20px; vertical-align: middle;"></ion-icon>
      <span style="vertical-align: middle; margin-left: 5px;">Filtros</span>
    </div>
    <div id="filtrosAdicionalesContainer" class="filtros-adicionales-ocultos">
      <div class="filter-item">
      <input type="number" id="filtroUnidadesPapeleria" class="form-control" placeholder="Mín. Unidades" title="Unidades Disponibles" min="0" oninput="aplicarFiltrosYOrdenarPapeleria()">
      <input type="number" id="filtroTiempoStoragePapeleria" class="form-control" placeholder="Mín. Tiempo Storage (días)" title="Mínimo de Tiempo en Storage (días)" min="0" oninput="aplicarFiltrosYOrdenarPapeleria()">
      
        <label for="filtroEstadoPapeleriaSelect">Estado:</label>
        <select id="filtroEstadoPapeleriaSelect" class="form-control" >
          <option value="activo" selected>Activo</option>
          <option value="desactivado">Desactivado</option>
          <option value="">Todos</option>
        </select>
      </div>
      <button onclick="limpiarTodosLosFiltros()" class="btn btn-outline">Limpiar Filtros</button>
    </div>
  </div>

  <div id="sortContainer">
    <span>Ordenar por Fecha de Ingreso:</span>
    <i class="fas fa-sort sort-menu-icon" onclick="ordenarPorFecha(event)"></i>
    <div id="sortOptionsPapeleria" class="sort-options">
      <a href="#" onclick="ordenarAscendente(); return false;">Ascendente</a>
      <a href="#" onclick="ordenarDescendente(); return false;">Descendente</a>
    </div>
  </div>

  <!-- Mensaje de "sin datos" que espera el JS -->
<div id="noData" class="no-data-container" style="display:none;">
  <i class="fas fa-inbox no-data-icon"></i>
  <h3 class="no-data-title">No se encontraron artículos de inventario Papeleria</h3>
  <p>Haz clic en "Agregar producto" para añadir tu primer artículo</p>
</div>

  <div class="table-container-Papeleria">
    <table id="papeleriaTable" class="inventory-table">
      <thead>
        <tr>
          <th>ID</th>
          <th>Producto</th>
          <th>Fecha de Ingreso</th>
          <th>Ingresos</th>
          <th>Salidas</th>
          <th>Unidades disponibles</th>
         
          <th>Imagen</th>
          <th>Acciones</th>
        </tr>
      </thead>
      <tbody id="tablaPapeleriaBody"></tbody>
    </table>
    <div id="papeleriaPagination" class="pagination"></div>
  </div>

  <!-- Modals -->
  <div id="modalAgregarPapeleria" class="modal-overlay">
    <div class="modal-content-ac">
      <div class="modal-header">
        <h2>Agregar Papelería</h2>
        <span class="close-btn" onclick="cerrarModalAgregar()">&times;</span>
      </div>
      <form id="agregarPapeleriaForm">
        <div class="form-group">
          <label for="productoAgregarPapeleria">Nombre del Producto *:</label>
          <input type="text" id="productoAgregarPapeleria"name= "productoAgregar" class="form-control" required>
        </div>
        <div class="form-group">
          <label for="ingresosAgregarPapeleria">Unidades a Ingresar *:</label>
          <input type="number" id="ingresosAgregarPapeleria" class="form-control" min="0" required>
        </div>
        <div class="form-group">
          <label for="imagenArchivoAgregarPapeleria">Imagen (desde equipo):</label>
          <input type="file" id="imagenArchivoAgregarPapeleria" class="form-control" accept="image/*">
        </div>
        <div class="form-group">
          <label for="comentariosAgregarPapeleria">Comentarios:</label>
          <textarea id="comentariosAgregarPapeleria" rows="4" class="form-control"></textarea>
        </div>
        <div class="modal-footer">
          <button type="submit" class="btn btn-primary">Guardar Papelería</button>
        </div>
      </form>
    </div>
  </div>
<!--EDITAR--> 
  <div id="modalEditarPapeleria" class="modal-overlay">
    <div class="modal-content-ac">
      <div class="modal-header">
        <h2>Modificar Papelería</h2>
        <span class="close-btn" onclick="cerrarModalEditar()">&times;</span>
      </div>
      <p>ID de Papelería: <span id="productoIdEditarPapeleria"></span></p>
      <form id="editarPapeleriaForm">
        <div class="form-group">
          <label for="productoEditarPapeleria">Nombre del Producto *:</label>
          <input type="text" id="productoEditarPapeleria" class="form-control" required>
        </div>
        <div class="form-group">
          <label for="unidadesAgregarEditarPapeleria">Unidades a agregar *:</label>
          <input type="number" id="unidadesAgregarEditarPapeleria" class="form-control" min="0" value="0" required>
        </div>
        <div class="form-group">
          <label for="imagenEditarPapeleria">URL de Imagen:</label>
          <input type="text" id="imagenEditarPapeleria" class="form-control">
        </div>
         <div class="form-group">
            <label for="comentariosEditarPapeleria">Comentarios:</label>
            <textarea id="comentariosEditarPapeleria" rows="4" class="form-control"></textarea>
        </div>
        <div class="modal-footer">
          <button type="submit" class="btn btn-primary">
            <ion-icon name="cloud-upload-outline"></ion-icon> Guardar Cambios
          </button>
        </div>
      </form>
    </div>
  </div>
<!--Retirar-->
  <div id="modalRetiroPapeleria" class="modal-overlay">
    <div class="modal-content-ac">
      <div class="modal-header">
        <h2>Retirar Elemnto de la Papelería</h2>
        <span class="close-btn" onclick="cerrarModalRetiro()">&times;</span>
      </div>
      <p>ID de Papelería: <span id="productoIdRetiroPapeleria"></span></p>
      <p>Producto: <span id="productoNombreRetiroPapeleria"></span></p>
      <p>Unidades Disponibles: <span id="unidadesDisponiblesRetiroPapeleria"></span></p>
      <form id="retiroPapeleriaForm">
        <div class="form-group">
          <label for="unidadesRetirarPapeleria">Unidades a retirar *:</label>
          <input type="number" id="unidadesRetirarPapeleria" class="form-control" min="1" required>
        </div>
        <div class="modal-footer">
          <button type="submit" class="btn btn-primary">
            <span><ion-icon name="bag-check-outline"></ion-icon></span> Retirar
          </button>
        </div>
      </form>
    </div>
  </div>
<!--Comentarios-->
  <div id="modalComentarioPapeleria" class="modal-overlay">
    <div class="modal-content-ac">
      <div class="modal-header">
        <h2>Agregar Comentario</h2>
        <span class="close-btn" onclick="cerrarModalComentario()">&times;</span>
      </div>
      <p>ID de Papelería: <span id="comentarioProductoIdPapeleria"></span></p>
      <p>Producto: <span id="comentarioProductoNombrePapeleria"></span></p>
      <form id="comentarioPapeleriaForm">
        <div class="form-group">
          <label for="comentarioTextoPapeleria">Comentario *:</label>
          <textarea id="comentarioTextoPapeleria" class="form-control" rows="4" required></textarea>
        </div>
        <div class="modal-footer">
          <button type="submit" class="btn btn-primary">Guardar Comentario</button>
        </div>
      </form>
    </div>
  </div>
<!-- Modal de Notificaciones de Comentarios -->
<div id="modalNotificacion-Comentario" class="modal-overlay">
    <div class="modal-content-NotificacionesComentarios">
        <div class="modal-header">
            <h2 class="modal-title">
                <ion-icon name="chatbubble-ellipses-outline"></ion-icon> Mis Notificaciones de Comentarios
            </h2>
            <button class="btn-warning" onclick="cargarNotificacionesDeComentariosPapeleria()">
                <ion-icon name="refresh-outline"></ion-icon> Recargar
            </button>
            <button class="close-btn" onclick="cerrarModalNotificacionComentario()">&times;</button>
        </div>
        <div class="modal-body">
            <div class="tab-buttons-container">
                <button class="tab-button active" data-tab="pendientes-comentarios">Pendientes</button>
                <button class="tab-button" data-tab="leidas-comentarios">Leídas</button>
            </div>

            <!-- Pestaña de Pendientes -->
            <div id="pendientes-comentarios" class="tab-content active">
                <div class="table-container-notificaciones">
                    <table class="notifications-table">
                        <thead>
                            <tr>
                                <th>Producto</th>
                                <th>Tu Comentario</th>
                                <th>Respuesta del Admin</th>
                                <th>Acción</th>
                            </tr>
                        </thead>
                        <tbody id="notificacionesPendientesBody"></tbody>
                    </table>
                </div>
            </div>

            <!-- Pestaña de Leídas -->
            <div id="leidas-comentarios" class="tab-content">
                <div class="table-container-notificaciones">
                    <table class="notifications-table">
                        <thead>
                            <tr>
                                <th>Producto</th>
                                <th>Tu Comentario</th>
                                <th>Respuesta</th>
                                <th>Acción</th>
                            </tr>
                        </thead>
                        <tbody id="notificacionesLeidasBody"></tbody>
                    </table>
                </div>
            </div>
        </div>
        <div class="modal-footer">
            <p class="footer-info">Aquí puedes ver las respuestas a tus comentarios.</p>
        </div>
    </div>
</div>
</div>


<!--Mensajes de confirmacion-->
  <div id="mensajeConfirmacionPapeleria" class="mensaje-confirmacion" style="display:none;">
    <span></span>
    <button onclick="cerrarMensaje()">Cerrar</button>
  </div>
</div>

<?!= include("View/Js/Js_Generico.html"); ?>
<?!= include("View/Js/Js_Papeleria.html"); ?>
<?!= include("View/Js/Js_Notifications.html"); ?>

<script>
  function cerrarModalNotificacionComentario() {
    const modal = document.getElementById('modalNotificacion-Comentario');
    if (modal) {
        modal.style.display = 'none';
    }
  }
</script>